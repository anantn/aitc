# HG changeset patch
# Parent f6e7e5e993f97c607a6dcd0fa40ce2be141e34d2

diff --git a/services/aitc/tests/unit/head_global.js b/services/aitc/tests/unit/head_global.js
--- a/services/aitc/tests/unit/head_global.js
+++ b/services/aitc/tests/unit/head_global.js
@@ -48,27 +48,8 @@ function addResourceAlias() {
   let modules = ["aitc", "common"];
   for each (let module in modules) {
     let uri = Services.io.newURI("resource:///modules/services-" + module + "/",
                                  null, null);
     handler.setSubstitution("services-" + module, uri);
   }
 }
 addResourceAlias();
-
-Cu.import("resource://services-common/utils.js");
-function httpd_setup (handlers, port) {
-  let port   = port || 8080;
-  let server = new nsHttpServer();
-  for (let path in handlers) {
-    server.registerPathHandler(path, handlers[path]);
-  }
-  try {
-    server.start(port);
-  } catch (ex) {
-    do_print("==========================================");
-    do_print("Got exception starting HTTP server on port " + port);
-    do_print("Error: " + CommonUtils.exceptionStr(ex));
-    do_print("Is there a process already listening on port " + port + "?");
-    do_print("==========================================");
-    do_throw(ex);
-  }
-}
diff --git a/services/aitc/tests/unit/xpcshell.ini b/services/aitc/tests/unit/xpcshell.ini
--- a/services/aitc/tests/unit/xpcshell.ini
+++ b/services/aitc/tests/unit/xpcshell.ini
@@ -1,7 +1,7 @@
 [DEFAULT]
-head = head_global.js
+head = head_global.js ../../../common/tests/unit/head_helpers.js ../../../common/tests/unit/head_aitc_server.js
 tail =
 
 [test_load_modules.js]
 [test_storage_queue.js]
 [test_storage_registry.js]
\ No newline at end of file
